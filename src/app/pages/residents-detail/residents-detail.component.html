<ng-container *ngIf="!error; else errorTpl">
  <div *ngIf="resident" class="container mx-auto p-4 md:p-6">
    <div class="card bg-base-100 shadow-xl relative">
      <div class="card-body pt-6">
        <h2 class="card-title text-2xl font-semibold mb-4 text-center md:text-left">Perfil do Residente</h2>

        <!-- Botões de Ação -->
        <div class="flex flex-wrap justify-center md:justify-end gap-2 mb-4">
          <a [routerLink]="['/residents', resident.id, 'healthreport']" class="btn btn-primary inline-flex items-center gap-1 text-xs md:text-base hover:bg-primary-dark">
            <!-- Ícone de Relatórios Médicos -->
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 md:h-5 md:w-5" viewBox="0 0 20 20" fill="currentColor">
              <path d="M8 9a3 3 0 110-6 3 3 0 010 6zm5-3a2 2 0 112 2 2 2 0 01-2-2zm5 5a7 7 0 01-14 0V5a7 7 0 0114 0v6zm-6 5a6 6 0 100-12 6 6 0 000 12z" />
            </svg>
            Relatórios
          </a>
          <a [routerLink]="['/residents', resident.id, 'medicaments']"  class="btn btn-secondary inline-flex items-center gap-1 text-xs md:text-base hover:bg-secondary-dark">
            <!-- Ícone de Medicação -->
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 md:h-5 md:w-5" viewBox="0 0 20 20" fill="currentColor">
              <path d="M12.293 7.293a1 1 0 011.414 0l2 2a1 1 0 010 1.414l-6 6a1 1 0 01-1.414 0l-2-2a1 1 0 010-1.414l6-6zM9 11a2 2 0 10-2-2 2 2 0 002 2z" />
            </svg>
            Medicação
          </a>
          <a [routerLink]="['/residents', resident.id, 'appointments']" class="btn btn-accent inline-flex items-center gap-1 text-xs md:text-base hover:bg-accent-dark">
            <!-- Ícone de Consultas -->
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 md:h-5 md:w-5" viewBox="0 0 20 20" fill="currentColor">
              <path d="M10 3a1 1 0 01.894.553l3 6a1 1 0 01-.042.967l-3 6A1 1 0 019 16H5a1 1 0 01-.894-1.447l3-6A1 1 0 019 7h4a1 1 0 01.894-.553zM9 4.5a.5.5 0 100 1 .5.5 0 000-1zm1 10a.5.5 0 100 1 .5.5 0 000-1z" />
            </svg>
            Consultas
          </a>
          <a [routerLink]="['/residents', resident.id, 'edit']" class="btn btn-info inline-flex items-center gap-1 text-xs md:text-base hover:bg-info-dark">
            <!-- Ícone de Editar -->
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 md:h-5 md:w-5" viewBox="0 0 20 20" fill="currentColor">
              <path d="M17.586 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.758-7.758a2 2 0 000-2.828z" />
              <path fill-rule="evenodd" d="M3 14.75A2.75 2.75 0 015.75 12h8.5A2.75 2.75 0 0117 14.75v2.5A2.75 2.75 0 0114.25 20h-8.5A2.75 2.75 0 013 17.25v-2.5zM5.75 13.5a.75.75 0 00-.75.75v2.5a.75.75 0 00.75.75h8.5a.75.75 0 00.75-.75v-2.5a.75.75 0 00-.75-.75h-8.5z" clip-rule="evenodd" />
            </svg>
            Editar
          </a>
          <button (click)="showDeleteModal()" class="btn btn-error inline-flex items-center gap-1 text-xs md:text-base hover:bg-error-dark">
            <!-- Ícone de Eliminar -->
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 md:h-5 md:w-5" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M6 2a2 2 0 012-2h4a2 2 0 012 2h5a1 1 0 010 2h-1v12a2 2 0 01-2 2H4a2 2 0 01-2-2V4H1a1 1 0 110-2h5zm4 5a1 1 0 00-1 1v6a1 1 0 002 0V8a1 1 0 00-1-1z" clip-rule="evenodd" />
            </svg>
            Eliminar
          </button>
        </div>

        <!-- Perfil e informações do residente -->
        <div class="flex flex-col md:flex-row items-center md:items-start gap-4 md:gap-6">
          <div class="avatar">
            <div class="w-32 h-32 md:w-40 md:h-52 rounded-lg ring ring-primary ring-offset-base-100 ring-offset-2 overflow-hidden">
              <!-- <img [src]="resident.image || 'https://via.placeholder.com/150'" alt="Foto do Residente" class="object-cover w-full h-full" /> -->
            </div>
          </div>


          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-base-200 rounded-lg w-full md:h-52">
            <div class="space-y-2">
              <p><span class="font-bold">Nome:</span> {{ resident.name }}</p>
              <p><span class="font-bold">ID Fiscal:</span> {{ resident.fiscalId }}</p>
              <p><span class="font-bold">Data de Nascimento:</span> {{ resident.birthDate | date: 'dd MMMM yyyy' }}</p>
              <p><span class="font-bold">Nacionalidade:</span> {{ resident.nationality }}</p>
            </div>
            <div class="space-y-2">
              <p><span class="font-bold">Estado Civil:</span> {{ resident.civilStatus }}</p>
              <p><span class="font-bold">Número da Cama:</span> {{ resident.bedNumber }}</p>
              <p><span class="font-bold">Parentes:</span> {{ resident.relatives.length }} registrado(s)</p>
            </div>
          </div>
        </div>

        <div class="divider my-4"></div>

        <!-- Cuidados específicos -->
        <div>
          <h3 class="text-xl font-semibold mb-2 text-center md:text-left">Cuidados Específicos</h3>
          <p class="text-center md:text-left">{{ resident.specificCare || 'Nenhum cuidado específico registrado' }}</p>
        </div>

        <div class="divider my-4"></div>

        <!-- Informações alimentares e alergias -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-start">
          <div>
            <h3 class="text-xl font-semibold mb-2 text-center md:text-left">Informações Alimentares</h3>
            <p><span class="font-bold">Dieta:</span> {{ resident.diet }}</p>
            <p><span class="font-bold">Restrições Alimentares:</span> {{ resident.dietRestrictions || 'Nenhuma restrição' }}</p>
          </div>

          <div class="divider md:hidden"></div>

          <div>
            <h3 class="text-xl font-semibold mb-2 text-center md:text-left">Alergias</h3>
            <p><span class="font-bold">Alergias:</span> {{ resident.allergies || 'Nenhuma alergia registrada' }}</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal de Confirmação -->
    <app-modal-confirm
      title="Apagar Residente"
      message="Tem certeza de que deseja excluir este residente?"
      confirmLabel="Eliminar"
      (confirm)="onDelete()"
    ></app-modal-confirm>
  </div>

  @if(!resident) {
    <app-loading />
  }
</ng-container>

<!-- Template de Erro -->
<ng-template #errorTpl>
  <p class="text-error p-4">{{ error }}</p>
</ng-template>
